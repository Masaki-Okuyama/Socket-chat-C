# Socket-chat-C
ソケット通信を用いた簡易的なチャットソフトをC言語で作成

## serv.c  
サーバ用プログラムは、クライアントからの通信要求を受け付け、一連の処理を行うプログラムである。クライアントが新たに接続された場合、他クライアントに新たなクライアントがログインしたという旨のメッセージを送信する。接続しているクライアント数が上限に達した場合、警告文を全クライアントに送信し、それ以上のコネクションの要求を受け入れない。"LOGOUT"メッセージを受信した場合、他クライアントにログアウトのメッセージを送信し、そのクライアントに"LOGOUT"メッセージを送信する。通常のメッセージを受信した場合、全クライアントにメッセージを送信する。キーボードからの標準入力"SERVER_END"があるまで、クライアントとのデータの送受信を行う。Ctrl+Cによる強制終了などでサーバのソケットが先に閉じられた場合にも、クライアントのソケットを閉じるようなプログラムになってはいるが、本チャットソフトでは推奨されていない。

  
## cli.c  
クライアント用プログラムは、サーバに通信要求を送信するプログラム。サーバ側のIPアドレスとユーザ名を標準入力させる。キーボードからの標準入力をサーバへ送信し、サーバから受信したデータを標準出力する。"LOGOUT"メッセージを送信し、"LOGOUT"メッセージを受信するとプログラムを終了する。"SERVER_END"メッセージを受け取った場合、またはCtrl+Cなどでサーバのソケットが閉じられた場合も同様に、プログラムを終了する。  


## 全体の動作  
このチャットソフトは、サーバとクライアント間の通信をソケット通信で実現している。プログラム実行時は、サーバ用プログラムをクライアントの接続よりも先に実行する必要がある。   
両プログラムを実行すると、まずクライアント側でユーザ名と接続先サーバのIPアドレスを標準入力する。接続、設定が行われ、サーバとの接続が完了するとログインメッセージをサーバ側とクライアント側で表示し、データの送受信が可能になる。クライアントからサーバへ送信されるデータは、キーボード入力された文字列だけである。サーバは受信したデータを元に、クライアントへ送信するデータを決めて送信する。データを受信したクライアントは、受け取った内容を標準出力する。  
ただし、"LOGOUT"メッセージ,"SERVER_END"メッセージを受信したクライアントはプログラムを終了する。サーバは"SERVER_END"がキーボード入力された場合に"SERVER_END"を、"LOGOUT"を受信した場合に"LOGOUT"を送信する。"SERVER_END"を送信したサーバは、全てのクライアントのソケットが閉じられるのを待ってから、ソケットを閉じてプログラムを終了する。
